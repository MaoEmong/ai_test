# TASK05: 자연어 응답 생성 설계

## 배경
현재 서버는 LLM으로 CRUD 계획을 만든 뒤 DB를 실행하고 구조화된 결과(rows/affected_rows)를 그대로 반환한다. 클라이언트는 자연어 결과를 기대하므로, 실행 결과를 요약/서술하는 자연어 응답 레이어가 필요하다.

## 목표
- DB 실행 결과를 한국어 자연어 응답으로 변환해 `message`로만 클라이언트에 전달한다.
- 클라이언트는 `message`만 사용하며, 구조화 결과는 내부 처리용이다.
- 요약은 간결하고 일관된 형식을 유지한다.
- 결과가 많을 때는 샘플만 보여주고 나머지는 요약한다.

## 응답 정책
- READ
  - 결과가 0건이면: "조건에 맞는 결과가 없습니다."
  - 결과가 있으면: 총 건수 + 상위 N건 요약(기본 5건)
- INSERT
  - 성공: "N건이 추가되었습니다."
- UPDATE
  - 성공: "N건이 수정되었습니다."
- DELETE
  - 성공: "N건이 삭제되었습니다."

## 출력 형태(예시)
```
{
  "plan": { ... },
  "sql": "...",
  "result": { "rows": [...] },
  "message": "총 3건 조회되었습니다. 예: (id=1, name=..., price=..., qty=...)"
}
```

## 클라이언트 응답 정책
- 클라이언트에게는 `message`만 응답한다.
- 사용자가 읽기 쉬운 자연어 문장으로 전달한다.

## 응답 예시(message만 전달, 다정한 톤)
- READ (결과 없음): "조건에 맞는 결과가 없어요."
- READ (결과 있음, 소량): "총 3건을 찾았어요. 예: (id=1, name=사과, price=1000, qty=5)"
- READ (결과 있음, 다수): "총 120건을 찾았어요. 상위 5건만 보여드릴게요: (id=1, name=사과, price=1000, qty=5), (id=2, name=배, price=1500, qty=3)..."
- INSERT: "1건을 추가했어요."
- UPDATE: "2건을 수정했어요."
- DELETE: "5건을 삭제했어요."

## 구현 포인트
- `app/formatter.py` 신규 모듈 추가
  - `format_result(plan, result) -> str`
  - 샘플 건수 상수 `SAMPLE_ROWS = 5`
- `app/routes.py`
  - READ/INSERT/UPDATE/DELETE 반환 시 `message` 필드 추가
  - 클라이언트 응답은 `message`만 사용하도록 구성

## 예외/주의
- rows가 비정형이거나 일부 컬럼이 누락될 수 있으므로 안전하게 문자열 생성
- 응답 메시지는 한국어 기본

## 다음 작업
- formatter 모듈 구현
- `/run` 응답에 자연어 메시지 필드 연결
